<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 260" font-family="'Segoe UI', Arial, sans-serif">
  <defs>
    <filter id="shadow" x="-10%" y="-10%" width="120%" height="130%">
      <feDropShadow dx="0" dy="2" stdDeviation="3" flood-color="#00000020"/>
    </filter>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#94a3b8"/>
    </marker>
    <linearGradient id="g1" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#dbeafe"/>
      <stop offset="100%" style="stop-color:#bfdbfe"/>
    </linearGradient>
    <linearGradient id="g2" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#dcfce7"/>
      <stop offset="100%" style="stop-color:#bbf7d0"/>
    </linearGradient>
    <linearGradient id="g3" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#fef9c3"/>
      <stop offset="100%" style="stop-color:#fde68a"/>
    </linearGradient>
    <linearGradient id="g4" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#ede9fe"/>
      <stop offset="100%" style="stop-color:#ddd6fe"/>
    </linearGradient>
    <linearGradient id="g5" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#ffe4e6"/>
      <stop offset="100%" style="stop-color:#fecdd3"/>
    </linearGradient>
  </defs>

  <!-- Title -->
  <text x="500" y="28" text-anchor="middle" font-size="15" font-weight="700" fill="#1e293b">Path Signature Anomaly Detection Pipeline</text>

  <!-- Stage 1: Corpus -->
  <rect x="20" y="50" width="165" height="165" rx="12" fill="url(#g1)" stroke="#3b82f6" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="102" y="75" text-anchor="middle" font-size="12" font-weight="700" fill="#1d4ed8">① Corpus</text>
  <line x1="40" y1="82" x2="165" y2="82" stroke="#3b82f6" stroke-width="0.8" stroke-dasharray="4,3"/>
  <text x="102" y="103" text-anchor="middle" font-size="11" fill="#1e40af">Project Gutenberg</text>
  <text x="102" y="121" text-anchor="middle" font-size="11" fill="#1e40af">English books</text>
  <text x="102" y="145" text-anchor="middle" font-size="10.5" fill="#374151">Normal: ≥10 books/author</text>
  <text x="102" y="163" text-anchor="middle" font-size="10.5" fill="#374151">Impostor: M. Oliphant</text>
  <text x="102" y="183" text-anchor="middle" font-size="10.5" fill="#374151">10 × 512-token chunks</text>

  <!-- Arrow 1→2 -->
  <line x1="187" y1="132" x2="213" y2="132" stroke="#94a3b8" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- Stage 2: Embeddings -->
  <rect x="215" y="50" width="165" height="165" rx="12" fill="url(#g2)" stroke="#22c55e" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="297" y="75" text-anchor="middle" font-size="12" font-weight="700" fill="#15803d">② Embeddings</text>
  <line x1="235" y1="82" x2="360" y2="82" stroke="#22c55e" stroke-width="0.8" stroke-dasharray="4,3"/>
  <text x="297" y="103" text-anchor="middle" font-size="11" fill="#166534">RoBERTa-large</text>
  <text x="297" y="121" text-anchor="middle" font-size="11" fill="#166534">GPU inference</text>
  <text x="297" y="145" text-anchor="middle" font-size="10.5" fill="#374151">512 tokens → (512, 1024)</text>
  <text x="297" y="163" text-anchor="middle" font-size="10.5" fill="#374151">stream embeddings</text>
  <text x="297" y="183" text-anchor="middle" font-size="10.5" fill="#374151">stored as zarr arrays</text>

  <!-- Arrow 2→3 -->
  <line x1="382" y1="132" x2="408" y2="132" stroke="#94a3b8" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- Stage 3: Feature Extraction -->
  <rect x="410" y="50" width="175" height="165" rx="12" fill="url(#g3)" stroke="#eab308" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="497" y="75" text-anchor="middle" font-size="12" font-weight="700" fill="#a16207">③ Feature Extraction</text>
  <line x1="430" y1="82" x2="565" y2="82" stroke="#eab308" stroke-width="0.8" stroke-dasharray="4,3"/>
  <text x="497" y="103" text-anchor="middle" font-size="11" fill="#92400e">Top-K token masking</text>
  <text x="497" y="121" text-anchor="middle" font-size="11" fill="#92400e">K ∈ {100, 250}</text>
  <text x="497" y="145" text-anchor="middle" font-size="10.5" fill="#374151">UMAP (2d / 4d)  or</text>
  <text x="497" y="163" text-anchor="middle" font-size="10.5" fill="#374151">Random Projection</text>
  <text x="497" y="183" text-anchor="middle" font-size="10.5" fill="#374151">Path Signature L1–4</text>

  <!-- Arrow 3→4 -->
  <line x1="587" y1="132" x2="613" y2="132" stroke="#94a3b8" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- Stage 4: Anomaly Detection -->
  <rect x="615" y="50" width="170" height="165" rx="12" fill="url(#g4)" stroke="#8b5cf6" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="700" y="75" text-anchor="middle" font-size="12" font-weight="700" fill="#6d28d9">④ Anomaly Detection</text>
  <line x1="635" y1="82" x2="765" y2="82" stroke="#8b5cf6" stroke-width="0.8" stroke-dasharray="4,3"/>
  <text x="700" y="103" text-anchor="middle" font-size="11" fill="#5b21b6">Isolation Forest</text>
  <text x="700" y="121" text-anchor="middle" font-size="11" fill="#5b21b6">trained on normal only</text>
  <text x="700" y="145" text-anchor="middle" font-size="10.5" fill="#374151">Score per chunk</text>
  <text x="700" y="163" text-anchor="middle" font-size="10.5" fill="#374151">KS test aggregation</text>
  <text x="700" y="183" text-anchor="middle" font-size="10.5" fill="#374151">per book</text>

  <!-- Arrow 4→5 -->
  <line x1="787" y1="132" x2="813" y2="132" stroke="#94a3b8" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- Stage 5: Evaluation -->
  <rect x="815" y="50" width="165" height="165" rx="12" fill="url(#g5)" stroke="#f43f5e" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="897" y="75" text-anchor="middle" font-size="12" font-weight="700" fill="#be123c">⑤ Evaluation</text>
  <line x1="835" y1="82" x2="960" y2="82" stroke="#f43f5e" stroke-width="0.8" stroke-dasharray="4,3"/>
  <text x="897" y="103" text-anchor="middle" font-size="11" fill="#9f1239">ROC AUC</text>
  <text x="897" y="121" text-anchor="middle" font-size="11" fill="#9f1239">impostor vs. normal</text>
  <text x="897" y="145" text-anchor="middle" font-size="10.5" fill="#374151">Best: 0.84</text>
  <text x="897" y="163" text-anchor="middle" font-size="10.5" fill="#374151">(UMAP, K=250, L=4)</text>
  <text x="897" y="183" text-anchor="middle" font-size="10.5" fill="#374151">4 dataset configs</text>

  <!-- Footer note -->
  <text x="500" y="238" text-anchor="middle" font-size="10" fill="#64748b">Datasets: Standardised Project Gutenberg Corpus · Embeddings: RoBERTa-large (HuggingFace) · Anomaly score: Isolation Forest + KS test</text>
</svg>
